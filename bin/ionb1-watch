#!/usr/bin/env ruby

require 'ionotify/blink1'
include Ionotify::Blink1

led = Tool.new
blink1 = Notifier.new(led)
notifier = FsEventAdapter.new(ARGV)

Signal.trap(:INT) do
  led.off
  exit
end

notifier.watch do |file|
  begin
    blink1.status(File.read(file).chomp)
  rescue
    STDERR.puts "Error: #{$!.message}"
  end
end

notifier.run
